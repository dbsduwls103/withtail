<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="myPage">
	<select id="listMyPages" parameterType="com.sp.withtail.myPage.MyPage" resultType="com.sp.withtail.myPage.MyPage">
		SELECT petName, breed, gender, whichPet, petsImageFilename, num
		FROM animal
		WHERE userId = #{userId}
	</select>
	
	<select id="readPet" parameterType="Long" resultType="com.sp.withtail.myPage.MyPage">
		SELECT num, petName, breed, gender, whichPet, petsImageFilename, weight, TO_CHAR(birth, 'YYYY"년"MM"월"DD"일" DY"요일"') AS birth,
		        TO_CHAR(birth, 'YYYY-MM-DD') AS birth2
		FROM animal
		WHERE num = ${num}
	</select>
	
	<delete id="deletePet" parameterType="Long"> 
		DELETE FROM animal WHERE num = #{num}
	</delete>
	
	<select id="dataCount" parameterType="String" resultType="Integer">
		SELECT NVL(COUNT(*), 0)
		FROM animal
		WHERE userId = #{userId}
	</select>
	
	<update id="petEdit" parameterType="com.sp.withtail.myPage.MyPage">
		UPDATE animal SET petName=#{petName} , breed=#{breed}, gender=#{gender}, petsImageFilename= #{petsImageFilename, jdbcType=VARCHAR}, birth=#{birth}, weight=#{weight}
		WHERE num =#{num}
	</update>
	
	<select id="listDelivery" parameterType="com.sp.withtail.myPage.MyPage" resultType="com.sp.withtail.myPage.MyPage">
		SELECT addNum, userId, addr1, addr2, zip, tel, memo, addDef, addName
		FROM address
		WHERE userId = #{userId}
	</select>
	
	<insert id="insertAdd" parameterType="com.sp.withtail.myPage.MyPage">
		INSERT INTO address(addNum, userId, addr1, addr2, zip, tel, memo, addDef, addName)
		VALUES (address_seq.NEXTVAL, #{userId}, #{addr1},#{addr2},#{zip},#{tel},#{memo},#{addDef},#{addName})
	</insert>
	
	<select id="readAdd" parameterType="Long" resultType="com.sp.withtail.myPage.MyPage">
		SELECT addNum, userId, addr1, addr2, zip, tel, memo, addDef, addName
		FROM address
		WHERE addNum = #{addNum}
	</select>
	
	<update id="updateAdd" parameterType="com.sp.withtail.myPage.MyPage">
		UPDATE address SET addr1=#{addr1}, addr2=#{addr2}, zip=#{zip}, tel=#{tel}, memo=#{memo}, addDef=#{addDef}, addName=#{addName}
		WHERE addNum = #{addNum}
	</update>
	
	<update id="basicAddressClear" parameterType="String">
		UPDATE address SET addDef = 0 WHERE userId = #{userId}
	</update>
	
	<delete id="deleteAdd" parameterType="Long">
		DELETE FROM address WHERE addNum = #{addNum}
	</delete>
</mapper>

